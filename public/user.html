<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Aktifkan Notifikasi</title>
</head>
<body>
  <h1>Aktifkan Notifikasi</h1>
  <button id="enable">Aktifkan</button>
  <p id="status"></p>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-messaging-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    firebase.initializeApp({
      apiKey: "AIzaSyCs_Jb63WZGevle_OXM2jlOS36aftE_29Y",
      authDomain: "adminvvip.firebaseapp.com",
      databaseURL: "https://adminvvip-default-rtdb.firebaseio.com",
      projectId: "adminvvip",
      storageBucket: "adminvvip.appspot.com",
      messagingSenderId: "911235567086",
      appId: "1:911235567086:web:8d178b73c3b48b790ed2ff",
      measurementId: "G-M5RS20R3P3"
    });

    const messaging = firebase.messaging();
    const db = firebase.database();

    navigator.serviceWorker.register('/sw.js').then(reg => {
      messaging.useServiceWorker(reg);
    });

    document.getElementById("enable").onclick = async () => {
      try {
        const token = await messaging.getToken({ vapidKey: "BFJKG8J6cnoeIESulLITwBFqNGIQ8CA74fELmWOR5tox-87kIb3HlfZBijG4FfiuNkBOYp0BNbweTXpd46PpS10" });
        if (token) {
          await db.ref("tokens").push(token);
          document.getElementById("status").textContent = "✅ Notifikasi diaktifkan!";
        } else {
          document.getElementById("status").textContent = "❌ Gagal mendapatkan token";
        }
      } catch (err) {
        document.getElementById("status").textContent = "Error: " + err.message;
      }
    };
  </script>
</body>
</html>