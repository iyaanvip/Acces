<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Realtime Notifikasi - User</title>
</head>
<body>
  <h1>Notifikasi Realtime</h1>
  <button id="enableNotif">Aktifkan Notifikasi</button>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-messaging-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCs_Jb63WZGevle_OXM2jlOS36aftE_29Y",
      authDomain: "adminvvip.firebaseapp.com",
      databaseURL: "https://adminvvip-default-rtdb.firebaseio.com",
      projectId: "adminvvip",
      storageBucket: "adminvvip.firebasestorage.app",
      messagingSenderId: "911235567086",
      appId: "1:911235567086:web:8d178b73c3b48b790ed2ff",
      measurementId: "G-M5RS20R3P3"
    };

    firebase.initializeApp(firebaseConfig);
    const messaging = firebase.messaging();
    const db = firebase.database();

    // Register custom service worker sw.js
    navigator.serviceWorker.register('sw.js').then((registration) => {
      messaging.useServiceWorker(registration);
    });

    document.getElementById("enableNotif").addEventListener("click", async () => {
      try {
        await Notification.requestPermission();
        const token = await messaging.getToken({
          vapidKey: "BFJKG8J6cnoeIESulLITwBFqNGIQ8CA74fELmWOR5tox-87kIb3HlfZBijG4FfiuNkBOYp0BNbweTXpd46PpS10"
        });
        if (token) {
          db.ref("tokens").push(token);
          alert("Notifikasi diaktifkan!");
        }
      } catch (err) {
        console.error("Gagal dapat token:", err);
      }
    });
  </script>
</body>
</html>